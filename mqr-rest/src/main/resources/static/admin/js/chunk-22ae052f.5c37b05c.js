(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22ae052f"],{"2fb7":function(t,o,e){},"5f1d":function(t,o,e){"use strict";e("2fb7")},"70c7":function(t,o,e){},9406:function(t,o,e){"use strict";e.r(o);var r=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"profile-box"},[e("div",{staticClass:"box-header"},[e("div",{staticClass:"avatar-wrapper"},[e("div",{staticClass:"avatar-box rotate",on:{click:t.robotInfoEdit}},[e("el-image",{staticStyle:{width:"120px",height:"120px","border-radius":"50%"},attrs:{src:t.robotInfo.qqAvatar,fit:"fit"}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t._v("机器人未配置")])])],1)]),e("div",{staticClass:"robot-info"},[e("span",[e("el-tag",{attrs:{size:"small",effect:"dark"}},[t._v(t._s(t.robotInfo.nickname))])],1),e("span",[e("el-tag",{attrs:{size:"small",effect:"dark"}},[t._v(t._s(t.robotInfo.qq))])],1),e("span",{staticStyle:{cursor:"pointer"},on:{click:t.robotStateConfirm}},[e("el-button",{attrs:{type:4==t.robotInfo.state?"success":"info",size:"small"}},[t._v(" "+t._s(t.robotInfo.stateMemo)+" "),e("i",{staticClass:"el-icon--right",class:{"el-icon-loading":4==t.robotInfo.state}})])],1)])]),e("div",{staticClass:"box-nav"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"配置账号",placement:"left-start"}},[e("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:t.robotInfoEdit}})],1),1!=t.robotInfo.state&&0!=t.robotInfo.state?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"停止运行",placement:"left-start"}},[e("el-button",{attrs:{type:"danger",icon:"el-icon-switch-button",circle:""},on:{click:t.robotStopConfirm}})],1):t._e(),1==t.robotInfo.state&&0!=t.robotInfo.state?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"启动运行",placement:"left-start"}},[e("el-button",{attrs:{type:"success",icon:"el-icon-video-play",circle:""},on:{click:t.robotStartSubmit}})],1):t._e(),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"白名单配置",placement:"left-start"}},[e("el-button",{attrs:{icon:"el-icon-check",circle:""}})],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"黑名单配置",placement:"left-start"}},[e("el-button",{attrs:{icon:"el-icon-close",circle:""}})],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"事件设置",placement:"left-start"}},[e("el-button",{attrs:{icon:"el-icon-setting",circle:""}})],1)],1),e("el-dialog",{staticClass:"dialog-robot",attrs:{title:"机器人账号配置",visible:t.robotInfoVisible,"append-to-body":!0},on:{"update:visible":function(o){t.robotInfoVisible=o}}},[e("el-form",{ref:"robotForm",attrs:{rules:t.robotRules,model:t.robotForm,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"QQ号",prop:"qq"}},[e("el-input",{ref:"qq",on:{focus:function(o){t.robotFormFocus.qq=!0},blur:function(o){t.robotFormFocus.qq=!1}},model:{value:t.robotForm.qq,callback:function(o){t.$set(t.robotForm,"qq",o)},expression:"robotForm.qq"}})],1),e("el-form-item",{attrs:{label:"QQ密码",prop:"password"}},[e("el-input",{ref:"password",attrs:{type:"password"},on:{focus:function(o){t.robotFormFocus.password=!0},blur:function(o){t.robotFormFocus.password=!1}},model:{value:t.robotForm.password,callback:function(o){t.$set(t.robotForm,"password",o)},expression:"robotForm.password"}})],1),e("el-form-item",{attrs:{label:"账号昵称",prop:"nickname"}},[e("el-input",{ref:"nickname",on:{focus:function(o){t.robotFormFocus.nickname=!0},blur:function(o){t.robotFormFocus.nickname=!1}},model:{value:t.robotForm.nickname,callback:function(o){t.$set(t.robotForm,"nickname",o)},expression:"robotForm.nickname"}})],1),e("el-form-item",{attrs:{prop:"admins",label:"管理员QQ"}},[e("el-input",{ref:"admins",attrs:{type:"textarea"},on:{focus:function(o){t.robotFormFocus.admins=!0},blur:function(o){t.robotFormFocus.admins=!1}},model:{value:t.robotForm.admins,callback:function(o){t.$set(t.robotForm,"admins",o)},expression:"robotForm.admins"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.robotInfoSubmit}},[t._v("保存")]),e("el-button",{on:{click:function(o){t.robotInfoVisible=!1}}},[t._v("取消")])],1)],1)],1),e("el-dialog",{staticClass:"robot-state-dialog",attrs:{title:"机器人状态",visible:t.robotStateVisible,width:"460px"},on:{"update:visible":function(o){t.robotStateVisible=o}}},[e("h2",{staticClass:"title"},[t._v(t._s(t.robotInfo.stateMemo))]),"URL"==t.robotVerify.type?e("div",[e("el-link",{attrs:{type:"success",href:t.robotVerify.content,target:"_blank"}},[t._v("如果下面无法显示二维码，点击这里新窗口打开"),e("i",{staticClass:"el-icon-link el-icon--right"})]),e("iframe",{staticClass:"verify-iframe",attrs:{src:t.robotVerify.content}})],1):t._e(),"IMG"==t.robotVerify.type?e("div",{staticClass:"verify-img-box"},[e("img",{attrs:{src:"data:image/png;base64,"+t.robotVerify.content}})]):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:"IMG"==t.robotVerify.type,expression:"robotVerify.type == 'IMG'"}]},[e("el-input",{attrs:{type:"primary",placeholder:"请输入验证信息"},model:{value:t.verifyCode,callback:function(o){t.verifyCode=o},expression:"verifyCode"}})],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(o){t.robotStateVisible=!1}}},[t._v("取 消")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:2==t.robotInfo.state,expression:"robotInfo.state == 2"}],attrs:{type:"primary"},on:{click:t.robotStateSubmit}},[t._v("提交验证")])],1)])],1)},n=[],i=(e("a15b"),e("b64b"),e("d3b7"),e("ac1f"),e("1276"),e("d354"));function s(){return Object(i["a"])("/sys-setting/robot-info",null)}function a(t){return Object(i["b"])("/sys-setting/robot-info",t)}function c(){return Object(i["a"])("/robot/start",null)}function l(){return Object(i["a"])("/robot/stop",null)}function b(){return Object(i["a"])("/sys-setting/robot-verify",null)}function f(t){return Object(i["c"])("/sys-setting/robot-verify",{code:t})}function u(t){return"http://q1.qlogo.cn/g?b=qq&nk="+t+"&s=100"}function m(t){var o="";switch(t){case 1:o="未启动";break;case 2:o="登录需要验证";break;case 3:o="登录中";break;case 4:o="运行中";break;case 9:o="已离线";break;default:o="未配置";break}return o}var d=null,p={name:"DashboardLogin",data:function(){return{robotInfoVisible:!1,robotStateVisible:!1,verifyCode:"",robotForm:{qq:"",nickname:"",password:"",admins:""},robotFormFocus:{qq:!1,nickname:!1,password:!1,admins:!1},robotInfo:{qq:"",nickname:"",password:"",admins:"",state:0,stateMemo:"",qqAvatar:""},robotVerify:{type:"",content:""},robotRules:{qq:[{required:!0,message:"QQ号不能为空",trigger:"blur"}],password:[{required:!0,message:"QQ密码不能为空",trigger:"blur"}],nickname:[{required:!0,message:"账号昵称不能为空",trigger:"blur"}]}}},created:function(){this.initRobotInfo(),d=setInterval(this.initRobotInfo,2e3)},destroyed:function(){clearInterval(d)},methods:{initRobotInfo:function(){var t=this;s().then((function(o){var e=o.data.data;null!=e&&(t.robotInfo.qq=e.qq,t.robotInfo.nickname=e.nickname,t.robotInfo.password=e.password,t.robotInfo.admins=e.admins.join(","),t.robotInfo.state=e.state,t.robotInfo.qqAvatar=u(e.qq),""!=t.robotForm.qq||t.robotFormFocus.qq||(t.robotForm.qq=e.qq),""!=t.robotForm.nickname||t.robotFormFocus.nickname||(t.robotForm.nickname=e.nickname),""!=t.robotForm.password||t.robotFormFocus.password||(t.robotForm.password=e.password),""!=t.robotForm.admins||t.robotFormFocus.admins||(t.robotForm.admins=e.admins.join(","))),t.robotInfo.stateMemo=m(t.robotInfo.state)}))},robotInfoEdit:function(){this.robotInfoVisible=!0},robotInfoSubmit:function(){var t=this;this.$refs["robotForm"].validate((function(o,e){if(o){if(null!=t.robotInfo.state&&0!=t.robotInfo.state&&1!=t.robotInfo.state)return void t.$message.warning("请先停止机器人后再编辑");var r=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"}),n=JSON.parse(JSON.stringify(t.robotForm));n.admins=n.admins.split(","),a(n).then((function(){t.robotInfo.qq=t.robotForm.qq,t.robotInfo.nickname=t.robotForm.nickname,t.robotInfo.password=t.robotForm.password,t.robotInfo.admins=t.robotForm.admins,t.robotInfo.qqAvatar=u(t.robotForm.qq),t.robotInfo.state=1,t.robotInfo.stateMemo=m(1),t.$message.success("保存成功")})).finally((function(){r.close(),t.robotInfoVisible=!1}))}else t.$refs[Object.keys(e)[0]].focus()}))},robotStartSubmit:function(){var t=this,o=this.$loading({lock:!0,text:"启动中",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"});c().then((function(){t.$notify({title:"启动中...",message:"请观察机器人头像下方动态，看是否需要登录验证",type:"success",duration:0})})).finally((function(){o.close()}))},robotStopConfirm:function(){var t=this;this.$confirm("确认停止机器人运行吗？").then((function(){var o=t.$loading({lock:!0,text:"停止中",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"});l().then((function(){t.$message.success("已停止运行")})).finally((function(){o.close()}))})).catch((function(){}))},robotStateConfirm:function(){var t=this;this.initRobotInfo(),2==this.robotInfo.state&&b().then((function(o){var e=o.data.data;t.robotVerify.type=e.type,t.robotVerify.content=e.content})),this.robotStateVisible=!0},robotStateSubmit:function(){var t=this,o=this.$loading({lock:!0,text:"提交中",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.8)"}),e="URL"==this.robotVerify.type?"yes":this.verifyCode;f(e).then((function(){t.$message.success("提交成功")})).finally((function(){o.close(),t.robotStateVisible=!1}))}}},v=p,k=(e("cda4"),e("5f1d"),e("2877")),g=Object(k["a"])(v,r,n,!1,null,"57e31520",null);o["default"]=g.exports},a15b:function(t,o,e){"use strict";var r=e("23e7"),n=e("44ad"),i=e("fc6a"),s=e("a640"),a=[].join,c=n!=Object,l=s("join",",");r({target:"Array",proto:!0,forced:c||!l},{join:function(t){return a.call(i(this),void 0===t?",":t)}})},cda4:function(t,o,e){"use strict";e("70c7")}}]);